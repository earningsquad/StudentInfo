<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/WdatePicker.css" />
<link rel="stylesheet" type="text/css" href="css/skin_/table.css" />
<link rel="stylesheet" type="text/css" href="css/jquery.grid.css" />


<title>表格</title>
</head>

<body>
<div id="container">
	<div id="hd"></div>
    <div id="bd">
    	<div id="main">
        
            <div class="table">
            	<div class="opt ue-clear">
                	
                	<span class="optarea">
                        <a href="javascript:;" class="add">
                            <i class="icon"></i>
                            <span class="text">添加</span>
                        </a>
                        <a href="javascript:;" class="delete">
                            <i class="icon"></i>
                            <span class="text" onclick="deleteOne()">删除</span>
                        </a>
                   
                
                    </span>
                </div>
                
                <div class="grid"></div>
                
                <div class="pagination"></div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/global.js"></script>
<script type="text/javascript" src="js/jquery.select.js"></script>
<script type="text/javascript" src="js/core.js"></script>
<script type="text/javascript" src="js/jquery.pagination.js"></script>
<script type="text/javascript" src="js/jquery.grid.js"></script>
<script type="text/javascript" src="js/WdatePicker.js"></script>
<script type="text/javascript">
    function ssss(flag,id) {
        return function () {
            checkScore(flag,id)
        }
    }


    var tbody=[[]]
    $.ajax({
        url : "http://localhost:8080/TeaSearchAllScore",
        type : "get",
        success : function(data) {
            tbody=data;

            var oper1=[
                {label:'已审核'}
            ]
            var oper2=[
                {label:'不予审核'}
            ]
            for(var tlength=0;tlength<tbody.length;tlength++){
                if(tbody[tlength][6]==1){
                    tbody[tlength].push(oper1)
                }
                else if(tbody[tlength][6]==-1){
                    tbody[tlength].push(oper2)
                }
                else  if(tbody[tlength][6]==0) {
                           var a=tbody[tlength][0]
                    tbody[tlength].push([{label:'审核',onclick:ssss(1,a)

                    },{label:'不予审核',onclick:ssss(-1,a)}]

                    )
                }
            }
        }
    })


    $('select').select();
    var head = [{
        label: 'ID',
        width: 100,
        sortable: 'default',
        name: 'id'
    },{
        label:'学生姓名',
        width: 150,
        sortable: 'default',
        name:'name'
    },{
        label:'课程名',
        width:150
    },{
        label: '分数',
        width: 150
    },{
        label: '任课老师',
        minWidth: 200
    },{
        label: '考试时间',
        width: 120
    }];


    $('.grid').Grid({
        thead: head,
        tbody: null,
        height:400,
        checkbox: {
            single:true
        },
        operator: {
            type : "normal",
            width : 100
        },
        sortCallBack : function(name,index,type){
            alert(name+","+index+','+type);
        }

    });

    $('.grid').Grid('addLoading');

    /// 模拟异步
    setTimeout(function(){
        $('.grid').Grid('setData',tbody, head);
    },2000)


    $('.pagination').pagination(100,{
        callback: function(page){
            alert(page);
        },
        display_msg: false
    });

    $('.search-box input[type=radio]').click(function(e) {
        if($(this).prop('checked')){
            if($(this).attr('data-define') === 'define'){
                $('.define-input').show();
            }else{
                $('.define-input').hide();
            }
        }
    });
    function checkScore(flag,id) {
          alert(flag+"---"+id)
        $.ajax({
            url: "http://localhost:8080/updateStuLessCheck",
            type: "POST",
            data: {'id': id, 'flag': flag},
            success: function (result) {
                         window.location.reload()

            },

        })
    }
function deleteOne(){
   var ck=$("input:checkbox")
    var flag
    var id
    $.each(ck,function(k,v){
        if($(this).attr('checked')=='checked')
           flag=(k-1)*7

    })

  id=$(".ui-table-td:eq("+flag+")").html()
    $.ajax({
        url: "http://localhost:8080/deleteScore",
        type: "POST",
        data: {'id': id},
        success: function (result) {
            window.location.reload()
        },

    })



}
</script>
</html>
